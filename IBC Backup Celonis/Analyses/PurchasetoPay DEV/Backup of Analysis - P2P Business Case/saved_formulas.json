[
  {
    "description": null,
    "id": "54f5ad8c-cb90-48c5-bf4f-199f79c6eba3",
    "name": "PI_TOTALPC",
    "parameterCount": 0,
    "parameters": [],
    "template": "COUNT(DISTINCT CASE WHEN process equals 'Change Price'  THEN EKPO.MANDT || EKPO.EBELN || EKPO.EBELP ELSE NULL END)"
  },
  {
    "description": null,
    "id": "77888168-8282-4047-92e7-cee104133450",
    "name": "Impact: Contract Usage",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= Time_Factor %>\n*(<%= CU_POT %>/100.0)\n*(<%= CU_NEGOTIATION %>/100.0)\n*(<%= CU_TARGET %>/100.0\n-\nKPI(\"Contract Usage Ratio\"))\n*\nSUM(\n    CASE \n    WHEN ISNULL(\"EKPO\".\"KONNR\")=1\n    AND \"EKKO\".\"BSART_TEXT\" IN (<%=CU_DOCTYPES%>)\n    AND ISNULL(\"LFA1\".\"VBUND\") = 1\n    THEN \"EKPO\".\"NETWR_CONVERTED\"\n    ELSE NULL\n    END\n)"
  },
  {
    "description": null,
    "id": "99c62ec3-c443-431e-b82c-ed4914a38398",
    "name": "Impact: Rework",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= Time_Factor %>*\r\n(\r\n--ACT 1\r\n\r\n(\r\n--minutes of rework activity\r\n<%= REWORK_ACT_1_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce rework\r\n*(<%= REWORK_ACT_1_POT %>/100.0)\r\n\r\n--quantity of rework activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = ('<%= REWORK_ACT_1 %>')\r\n    AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" = 'A'\r\n)\r\n)\r\n\r\n--ACT 2\r\n+\r\n\r\n--minutes of rework activity\r\n<%= REWORK_ACT_2_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce rework\r\n*(<%= REWORK_ACT_2_POT %>/100.0)\r\n\r\n--quantity of rework activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = ('<%= REWORK_ACT_2 %>')\r\n    AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" = 'A'\r\n)\r\n)\r\n\r\n\r\n--ACT 3\r\n+\r\n\r\n--minutes of rework activity\r\n<%= REWORK_ACT_3_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce rework\r\n*(<%= REWORK_ACT_3_POT %>/100.0)\r\n\r\n--quantity of rework activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = ('<%= REWORK_ACT_3 %>')\r\n    AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" = 'A'\r\n)\r\n)\r\n\r\n\r\n--ACT 4\r\n+\r\n\r\n--minutes of rework activity\r\n<%= REWORK_ACT_4_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce rework\r\n*(<%= REWORK_ACT_4_POT %>/100.0)\r\n\r\n--quantity of rework activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = ('<%= REWORK_ACT_4 %>')\r\n    AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" = 'A'\r\n)\r\n)\r\n\r\n\r\n--ACT 5\r\n+\r\n\r\n--minutes of rework activity\r\n<%= REWORK_ACT_5_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce rework\r\n*(<%= REWORK_ACT_5_POT %>/100.0)\r\n\r\n--quantity of rework activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = ('<%= REWORK_ACT_5 %>')\r\n    AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" = 'A'\r\n)\r\n)\r\n)\r\n)"
  },
  {
    "description": null,
    "id": "5003b45e-5f08-4275-889b-6a4bbcf7a18c",
    "name": "Impact: EDI",
    "parameterCount": 0,
    "parameters": [],
    "template": "--edi ratio difference\r\n(<%= EDI_TRGT %>/100.0\r\n-\r\n--edi actual ratio\r\n(\r\n1.0*\r\nSUM(PU_COUNT(\"EKKO\",\"NAST\".\"NACHA_TEXT\",\"NAST\".\"NACHA_TEXT\" IN (<%= EDI_ALLOWED %>)))\r\n/\r\n(1.0*\r\nSUM(PU_COUNT(\"EKKO\",\"NAST\".\"NACHA_TEXT\")))\r\n))\r\n*COUNT_TABLE(\"EKKO\")\r\n--times saving per sales order when processed via EDI\r\n*<%=EDI_SAVINGS%>\r\n--times FTE COST PER MINUTE\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n*<%= Time_Factor %>\r\n"
  },
  {
    "description": null,
    "id": "d2a5e09c-e20f-45e8-86c5-626d7c6cd7ac",
    "name": "Impact: Payment Blocks",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= Time_Factor %>*\r\n(\r\n\r\n(\r\n--minutes of BLOCK activity\r\n<%= BLOCK_ACT_1_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce BLOCK act\r\n*(<%= BLOCK_ACT_1_POT %>/100.0)\r\n\r\n--quantity of BLOCK activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= BLOCK_ACT_1 %>'\r\n)\r\n)\r\n\r\n+\r\n\r\n--minutes of BLOCK activity\r\n<%= BLOCK_ACT_2_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce BLOCK act\r\n*(<%= BLOCK_ACT_2_POT %>/100.0)\r\n\r\n--quantity of BLOCK activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= BLOCK_ACT_2 %>'\r\n)\r\n)\r\n\r\n+\r\n\r\n--minutes of BLOCK activity\r\n<%= BLOCK_ACT_3_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce BLOCK act\r\n*(<%= BLOCK_ACT_3_POT %>/100.0)\r\n\r\n--quantity of BLOCK activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= BLOCK_ACT_3 %>'\r\n)\r\n)\r\n\r\n)\r\n)"
  },
  {
    "description": null,
    "id": "3ff6cc44-c9e9-49a4-b42a-5632596666d8",
    "name": "Impact: Automation",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= Time_Factor %>*\r\n\r\n(\r\n\r\n--AUTOMATION ACTIVITY 1\r\n(\r\n--((AUTOMATION TARGET RATE * #ALL CASES) - #AUTOMATED CASES) * EFFORT * COST\r\n\r\n\r\n--AUTOMATION TARGET RATE\r\n(<%= AUTOMATION_ACT_1_TRGT %>/100.0\r\n\r\n\r\n--TIMES #ALL CASES: HOW MANY CASES ARE THERE THAT GO THROUGH CURRENT ACTIVITY WHERE WE KNOW THE USER TYPE? \r\n*\r\n(1.0*SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_1%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0\r\n)))\r\n--GIVES US THE TO BE REACHED AUTOMATED CASE COUNT\r\n\r\n\r\n--SUBTRACT THE CASE COUNT THAT ARE AUTOMATED IN THAT ACTIVITY (DISREGARDING NULL VALUES)\r\n-\r\n(SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_1%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0 AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" <> 'A'\r\n))))\r\n--GIVES US THE REMAINING CASE COUNT (CASES THAT SHOULD BE AUTOMATED BUT ARE NOT YET)\r\n\r\n\r\n--TIMES EFFORT (in min)\r\n*\r\n<%= AUTOMATION_ACT_1_EFF %>\r\n\r\n--TIMES FTE COST PER MINUTE\r\n*\r\n(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n)\r\n\r\n+\r\n\r\n--AUTOMATION ACTIVITY 2\r\n(\r\n--((AUTOMATION TARGET RATE * #ALL CASES) - #AUTOMATED CASES) * EFFORT * COST\r\n\r\n\r\n--AUTOMATION TARGET RATE\r\n(<%= AUTOMATION_ACT_2_TRGT %>/100.0\r\n\r\n\r\n--TIMES #ALL CASES: HOW MANY CASES ARE THERE THAT GO THROUGH CURRENT ACTIVITY WHERE WE KNOW THE USER TYPE? \r\n*\r\n(1.0*SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_2%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0\r\n)))\r\n--GIVES US THE TO BE REACHED AUTOMATED CASE COUNT\r\n\r\n\r\n--SUBTRACT THE CASE COUNT THAT ARE AUTOMATED IN THAT ACTIVITY (DISREGARDING NULL VALUES)\r\n-\r\n(SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_2%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0 AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" <> 'A'\r\n))))\r\n--GIVES US THE REMAINING CASE COUNT (CASES THAT SHOULD BE AUTOMATED BUT ARE NOT YET)\r\n\r\n\r\n--TIMES EFFORT (in min)\r\n*\r\n<%= AUTOMATION_ACT_2_EFF %>\r\n\r\n--TIMES FTE COST PER MINUTE\r\n*\r\n(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n)\r\n\r\n+\r\n\r\n--AUTOMATION ACTIVITY 3\r\n(\r\n--((AUTOMATION TARGET RATE * #ALL CASES) - #AUTOMATED CASES) * EFFORT * COST\r\n\r\n\r\n--AUTOMATION TARGET RATE\r\n(<%= AUTOMATION_ACT_3_TRGT %>/100.0\r\n\r\n\r\n--TIMES #ALL CASES: HOW MANY CASES ARE THERE THAT GO THROUGH CURRENT ACTIVITY WHERE WE KNOW THE USER TYPE? \r\n*\r\n(1.0*SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_3%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0\r\n)))\r\n--GIVES US THE TO BE REACHED AUTOMATED CASE COUNT\r\n\r\n\r\n--SUBTRACT THE CASE COUNT THAT ARE AUTOMATED IN THAT ACTIVITY (DISREGARDING NULL VALUES)\r\n-\r\n(SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_3%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0 AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" <> 'A'\r\n))))\r\n--GIVES US THE REMAINING CASE COUNT (CASES THAT SHOULD BE AUTOMATED BUT ARE NOT YET)\r\n\r\n\r\n--TIMES EFFORT (in min)\r\n*\r\n<%= AUTOMATION_ACT_3_EFF %>\r\n\r\n--TIMES FTE COST PER MINUTE\r\n*\r\n(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n)\r\n\r\n+\r\n\r\n--AUTOMATION ACTIVITY 4\r\n(\r\n--((AUTOMATION TARGET RATE * #ALL CASES) - #AUTOMATED CASES) * EFFORT * COST\r\n\r\n\r\n--AUTOMATION TARGET RATE\r\n(<%= AUTOMATION_ACT_4_TRGT %>/100.0\r\n\r\n\r\n--TIMES #ALL CASES: HOW MANY CASES ARE THERE THAT GO THROUGH CURRENT ACTIVITY WHERE WE KNOW THE USER TYPE? \r\n*\r\n(1.0*SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_4%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0\r\n)))\r\n--GIVES US THE TO BE REACHED AUTOMATED CASE COUNT\r\n\r\n\r\n--SUBTRACT THE CASE COUNT THAT ARE AUTOMATED IN THAT ACTIVITY (DISREGARDING NULL VALUES)\r\n-\r\n(SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_4%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0 AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" <> 'A'\r\n))))\r\n--GIVES US THE REMAINING CASE COUNT (CASES THAT SHOULD BE AUTOMATED BUT ARE NOT YET)\r\n\r\n\r\n--TIMES EFFORT (in min)\r\n*\r\n<%= AUTOMATION_ACT_4_EFF %>\r\n\r\n--TIMES FTE COST PER MINUTE\r\n*\r\n(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n)\r\n\r\n+\r\n\r\n--AUTOMATION ACTIVITY 5\r\n(\r\n--((AUTOMATION TARGET RATE * #ALL CASES) - #AUTOMATED CASES) * EFFORT * COST\r\n\r\n\r\n--AUTOMATION TARGET RATE\r\n(<%= AUTOMATION_ACT_5_TRGT %>/100.0\r\n\r\n\r\n--TIMES #ALL CASES: HOW MANY CASES ARE THERE THAT GO THROUGH CURRENT ACTIVITY WHERE WE KNOW THE USER TYPE? \r\n*\r\n(1.0*SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_5%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0\r\n)))\r\n--GIVES US THE TO BE REACHED AUTOMATED CASE COUNT\r\n\r\n\r\n--SUBTRACT THE CASE COUNT THAT ARE AUTOMATED IN THAT ACTIVITY (DISREGARDING NULL VALUES)\r\n-\r\n(SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_5%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0 AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" <> 'A'\r\n))))\r\n--GIVES US THE REMAINING CASE COUNT (CASES THAT SHOULD BE AUTOMATED BUT ARE NOT YET)\r\n\r\n\r\n--TIMES EFFORT (in min)\r\n*\r\n<%= AUTOMATION_ACT_5_EFF %>\r\n\r\n--TIMES FTE COST PER MINUTE\r\n*\r\n(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n)\r\n\r\n+\r\n\r\n--AUTOMATION ACTIVITY 6\r\n(\r\n--((AUTOMATION TARGET RATE * #ALL CASES) - #AUTOMATED CASES) * EFFORT * COST\r\n\r\n\r\n--AUTOMATION TARGET RATE\r\n(<%= AUTOMATION_ACT_6_TRGT %>/100.0\r\n\r\n\r\n--TIMES #ALL CASES: HOW MANY CASES ARE THERE THAT GO THROUGH CURRENT ACTIVITY WHERE WE KNOW THE USER TYPE? \r\n*\r\n(1.0*SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_6%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0\r\n)))\r\n--GIVES US THE TO BE REACHED AUTOMATED CASE COUNT\r\n\r\n\r\n--SUBTRACT THE CASE COUNT THAT ARE AUTOMATED IN THAT ACTIVITY (DISREGARDING NULL VALUES)\r\n-\r\n(SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_6%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0 AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" <> 'A'\r\n))))\r\n--GIVES US THE REMAINING CASE COUNT (CASES THAT SHOULD BE AUTOMATED BUT ARE NOT YET)\r\n\r\n\r\n--TIMES EFFORT (in min)\r\n*\r\n<%= AUTOMATION_ACT_6_EFF %>\r\n\r\n--TIMES FTE COST PER MINUTE\r\n*\r\n(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n)\r\n\r\n+\r\n\r\n--AUTOMATION ACTIVITY 7\r\n(\r\n--((AUTOMATION TARGET RATE * #ALL CASES) - #AUTOMATED CASES) * EFFORT * COST\r\n\r\n\r\n--AUTOMATION TARGET RATE\r\n(<%= AUTOMATION_ACT_7_TRGT %>/100.0\r\n\r\n\r\n--TIMES #ALL CASES: HOW MANY CASES ARE THERE THAT GO THROUGH CURRENT ACTIVITY WHERE WE KNOW THE USER TYPE? \r\n*\r\n(1.0*SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_7%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0\r\n)))\r\n--GIVES US THE TO BE REACHED AUTOMATED CASE COUNT\r\n\r\n\r\n--SUBTRACT THE CASE COUNT THAT ARE AUTOMATED IN THAT ACTIVITY (DISREGARDING NULL VALUES)\r\n-\r\n(SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_7%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0 AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" <> 'A'\r\n))))\r\n--GIVES US THE REMAINING CASE COUNT (CASES THAT SHOULD BE AUTOMATED BUT ARE NOT YET)\r\n\r\n\r\n--TIMES EFFORT (in min)\r\n*\r\n<%= AUTOMATION_ACT_7_EFF %>\r\n\r\n--TIMES FTE COST PER MINUTE\r\n*\r\n(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n)\r\n\r\n+\r\n\r\n--AUTOMATION ACTIVITY 8\r\n(\r\n--((AUTOMATION TARGET RATE * #ALL CASES) - #AUTOMATED CASES) * EFFORT * COST\r\n\r\n\r\n--AUTOMATION TARGET RATE\r\n(<%= AUTOMATION_ACT_8_TRGT %>/100.0\r\n\r\n\r\n--TIMES #ALL CASES: HOW MANY CASES ARE THERE THAT GO THROUGH CURRENT ACTIVITY WHERE WE KNOW THE USER TYPE? \r\n*\r\n(1.0*SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_8%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0\r\n)))\r\n--GIVES US THE TO BE REACHED AUTOMATED CASE COUNT\r\n\r\n\r\n--SUBTRACT THE CASE COUNT THAT ARE AUTOMATED IN THAT ACTIVITY (DISREGARDING NULL VALUES)\r\n-\r\n(SUM(PU_COUNT(\r\n   \"EKPO\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n   \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\"='<%=AUTOMATION_ACT_8%>' AND ISNULL(\"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\") = 0 AND \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\" <> 'A'\r\n))))\r\n--GIVES US THE REMAINING CASE COUNT (CASES THAT SHOULD BE AUTOMATED BUT ARE NOT YET)\r\n\r\n\r\n--TIMES EFFORT (in min)\r\n*\r\n<%= AUTOMATION_ACT_8_EFF %>\r\n\r\n--TIMES FTE COST PER MINUTE\r\n*\r\n(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n)\r\n\r\n\r\n)"
  },
  {
    "description": null,
    "id": "e1b41a25-d161-4d7f-9a2f-8afc36a5a03b",
    "name": "Impact: Supplier consolidation",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= Time_Factor %>\n*(\n(<%= SC_POT_1 %>/100.0)\n*(<%= SC_NEGOTIATION_1 %>/100.0)\n*(<%= SC_CONSOLFACTOR_1 %>/100.0)\n*SUM(\n    CASE WHEN \"EKPO\".\"MATKL\" = '<%= SC_MAT_1 %>'\n    THEN \"EKPO\".\"NETWR_CONVERTED\"\n    ELSE NULL\n    END)\n    \n+\n\n(<%= SC_POT_2 %>/100.0)\n*(<%= SC_NEGOTIATION_2 %>/100.0)\n*(<%= SC_CONSOLFACTOR_2 %>/100.0)\n*SUM(\n    CASE WHEN \"EKPO\".\"MATKL\" = '<%= SC_MAT_2 %>'\n    THEN \"EKPO\".\"NETWR_CONVERTED\"\n    ELSE NULL\n    END)\n    \n+\n\n(<%= SC_POT_3 %>/100.0)\n*(<%= SC_NEGOTIATION_3 %>/100.0)\n*(<%= SC_CONSOLFACTOR_3 %>/100.0)\n*SUM(\n    CASE WHEN \"EKPO\".\"MATKL\" = '<%= SC_MAT_3 %>'\n    THEN \"EKPO\".\"NETWR_CONVERTED\"\n    ELSE NULL\n    END)\n\n+\n\n(<%= SC_POT_4 %>/100.0)\n*(<%= SC_NEGOTIATION_4 %>/100.0)\n*(<%= SC_CONSOLFACTOR_4 %>/100.0)\n*SUM(\n    CASE WHEN \"EKPO\".\"MATKL\" = '<%= SC_MAT_4 %>'\n    THEN \"EKPO\".\"NETWR_CONVERTED\"\n    ELSE NULL\n    END)\n    \n+\n\n(<%= SC_POT_5 %>/100.0)\n*(<%= SC_NEGOTIATION_5 %>/100.0)\n*(<%= SC_CONSOLFACTOR_5 %>/100.0)\n*SUM(\n    CASE WHEN \"EKPO\".\"MATKL\" = '<%= SC_MAT_5 %>'\n    THEN \"EKPO\".\"NETWR_CONVERTED\"\n    ELSE NULL\n    END)\n)"
  },
  {
    "description": null,
    "id": "973e75bf-48b1-4459-b0c3-f4f6e1cdcec2",
    "name": "Testb",
    "parameterCount": 0,
    "parameters": [],
    "template": "SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_1 %>'\r\n)\r\n)\r\n\r\n* <%= CHANGE_ACT_1_EFF%>"
  },
  {
    "description": null,
    "id": "b074d285-5bed-4274-9555-5ccd273f502a",
    "name": "Breakeven: Cumulative Cost Year 2",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= COSTS_IM%> + 2*<%= COSTS_OP%> + <%= COSTS_LI%>*2"
  },
  {
    "description": null,
    "id": "d992a810-1c94-41cf-a592-0047c87a2ce2",
    "name": "Breakeven: Cumulative Return Year 1",
    "parameterCount": 0,
    "parameters": [],
    "template": "KPI(\"Breakeven: Cumulative Impact Year 1\") - KPI(\"Breakeven: Cumulative Cost Year 1\")"
  },
  {
    "description": null,
    "id": "99eeaae7-15a7-450d-84ee-160b6a7f289f",
    "name": "Breakeven: Cumulative Cost Year 1",
    "parameterCount": 0,
    "parameters": [],
    "template": "ROUND(<%= COSTS_IM%> + <%= COSTS_OP%> + <%= COSTS_LI%> )"
  },
  {
    "description": null,
    "id": "e8739b19-72d8-4c48-b5b6-9ba692586bf3",
    "name": "Impact: Manual changes",
    "parameterCount": 0,
    "parameters": [],
    "template": "ROUND(<%= Time_Factor %>*\r\n(\r\n\r\n(\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_1_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_1_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_1 %>'\r\n)\r\n)\r\n)\r\n\r\n+\r\n\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_2_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_2_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_2 %>'\r\n)\r\n)\r\n)\r\n\r\n+\r\n\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_3_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_3_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_3 %>'\r\n)\r\n)\r\n)\r\n\r\n+\r\n\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_4_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_4_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_4 %>'\r\n)\r\n)\r\n)\r\n\r\n+\r\n\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_5_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_5_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_5 %>'\r\n)\r\n)\r\n)\r\n\r\n+\r\n\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_6_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_6_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_6 %>'\r\n)\r\n)\r\n)\r\n\r\n+\r\n\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_7_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_7_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_7 %>'\r\n)\r\n)\r\n)\r\n\r\n+\r\n\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_8_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_8_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_8 %>'\r\n)\r\n)\r\n)\r\n\r\n+\r\n\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_9_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_9_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_9 %>'\r\n)\r\n)\r\n)\r\n\r\n+\r\n\r\n(\r\n--minutes of change activity\r\n<%= CHANGE_ACT_10_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_10_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_10 %>'\r\n)\r\n)\r\n)\r\n)\r\n))"
  },
  {
    "description": null,
    "id": "f8a27335-1cba-4ddf-93c0-65dae51e4d4b",
    "name": "PI_TOTALPI",
    "parameterCount": 0,
    "parameters": [],
    "template": "SUM(CASE\r\nWHEN\r\n  \r\nISNULL(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')) = 0\r\nAND \r\n--Nur Preiserh\u00c3\u00b6hungen\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\r\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') <= 1.0 \r\nTHEN \r\n   1.0\r\nELSE 0.0\r\nEND)"
  },
  {
    "description": null,
    "id": "dacf3d6e-c6bf-4e8e-aab1-ee426a3b3e33",
    "name": "Impact: OTD Late",
    "parameterCount": 0,
    "parameters": [],
    "template": "\n<%= Time_Factor %>\n--ANANLYSIS KPI = planned arrival date\n--GR_VARIABLE = actual arrival date\n--LATEST_DATE = latest date in dataset\n--DAYS_BETWEEN(X,Y) = Y - X [days]\n\n*SUM(CASE\n    \n    --NO PLANNED ARRIVAL TIME\n    WHEN ISNULL(<%= ANALYSIS_KPI %>) = 1 \n    THEN 0.0\n    --'No order confirmation'\n    \n    --ON TIME (POTENTIALLY)\n    WHEN ISNULL(<%= GR_VARIABLE %>) = 1 \n    AND DAYS_BETWEEN(TO_TIMESTAMP('<%= OTD_LATESTDATE %>','YYYYMMDD'),<%= ANALYSIS_KPI %>) >= 0 \n    THEN 0.0\n    --'No goods receipt but future due date'\n    --'On time delivery'\n    \n    --TOO LATE, NO GR\n    WHEN ISNULL(<%= GR_VARIABLE %>) = 1 \n    AND DAYS_BETWEEN(TO_TIMESTAMP('<%= OTD_LATESTDATE %>','YYYYMMDD'),<%= ANALYSIS_KPI %>)  < 0 \n    THEN \"EKPO\".\"NETWR_CONVERTED\"*ABS((DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>)/365.0))*(<%= ROIC %>/100.0)*(<%= OTD_LATE_SAFETYSTOCK %>/100.0)*(<%= OTD_LATE_POT %>/100.0)\n    --'No goods receipt and due date passed'\n    --'Late delivery'\n    \n    --ON TIME WITH EARLY INTERVAL\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) >= 0\n    AND DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) <= <%= OKIfDeliveredXdaysEarly %>\n    THEN 0.0\n    --'On time delivery'\n    --although a little early, it is within the early interval of everything between 0 to x days early\n    \n    --ON TIME WITH LATE INTERVAL\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) <= 0\n    AND DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) >= (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    THEN 0.0\n    --'On time delivery'\n    --although a little late, it is within the late interval of everything between 0 to x days late\n    \n    --TOO EARLY\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) > <%= OKIfDeliveredXdaysEarly %>\n    THEN 0.0\n    --'Early delivery'\n    --outside the On time delivery interval, too early\n    \n    --TOO LATE BUT SHORT NOTICE\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) < (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    --AND (confirmation date - create PO item date) < short notice threshold\n    AND DAYS_BETWEEN(PU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"EVENTTIME\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Create Purchase Order Item'), <%= ANALYSIS_KPI %>) < <%= ShortNoticeThreshold %>\n    THEN 0.0\n    --'Late delivery but short notice'\n    --'Delivery too late but short notice purchase order'\n    \n    --TOO LATE\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) < (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    THEN \"EKPO\".\"NETWR_CONVERTED\"*ABS((DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>)/365.0))*(<%= ROIC %>/100.0)*(<%= OTD_LATE_SAFETYSTOCK %>/100.0)*(<%= OTD_LATE_POT %>/100.0)\n    --'Late delivery'\n    --outside the On time delivery interval, too late\n    \n    ELSE 0.0\n    --'Other'\n    \nEND)\n\n+\n\n<%= Time_Factor %>\n\n--ANANLYSIS KPI = planned arrival date\n--GR_VARIABLE = actual arrival date\n--LATEST_DATE = latest date in dataset\n--DAYS_BETWEEN(X,Y) = Y - X [days]\n\n*SUM(CASE\n    \n    --NO PLANNED ARRIVAL TIME\n    WHEN ISNULL(<%= ANALYSIS_KPI %>) = 1 \n    THEN 0.0\n    --'No order confirmation'\n    \n    --ON TIME (POTENTIALLY)\n    WHEN ISNULL(<%= GR_VARIABLE %>) = 1 \n    AND DAYS_BETWEEN(TO_TIMESTAMP('<%= OTD_LATESTDATE %>','YYYYMMDD'),<%= ANALYSIS_KPI %>) >= 0 \n    THEN 0.0\n    --'No goods receipt but future due date'\n    --'On time delivery'\n    \n    --TOO LATE, NO GR\n    WHEN ISNULL(<%= GR_VARIABLE %>) = 1 \n    AND DAYS_BETWEEN(TO_TIMESTAMP('<%= OTD_LATESTDATE %>','YYYYMMDD'),<%= ANALYSIS_KPI %>)  < 0 \n    THEN \"EKPO\".\"NETWR_CONVERTED\"*ABS((DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>)/365.0))*(<%= OTD_LATE_SAFETYSTOCK %>/100.0)*(<%= OTD_LATE_INVENTORYCOST %>/100.0)*(<%= OTD_LATE_POT %>/100.0)\n    --'No goods receipt and due date passed'\n    --'Late delivery'\n    \n    --ON TIME WITH EARLY INTERVAL\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) >= 0\n    AND DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) <= <%= OKIfDeliveredXdaysEarly %>\n    THEN 0.0\n    --'On time delivery'\n    --although a little early, it is within the early interval of everything between 0 to x days early\n    \n    --ON TIME WITH LATE INTERVAL\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) <= 0\n    AND DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) >= (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    THEN 0.0\n    --'On time delivery'\n    --although a little late, it is within the late interval of everything between 0 to x days late\n    \n    --TOO EARLY\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) > <%= OKIfDeliveredXdaysEarly %>\n    THEN 0.0\n    --'Early delivery'\n    --outside the On time delivery interval, too early\n    \n    --TOO LATE BUT SHORT NOTICE\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) < (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    --AND (confirmation date - create PO item date) < short notice threshold\n    AND DAYS_BETWEEN(PU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"EVENTTIME\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Create Purchase Order Item'), <%= ANALYSIS_KPI %>) < <%= ShortNoticeThreshold %>\n    THEN 0.0\n    --'Late delivery but short notice'\n    --'Delivery too late but short notice purchase order'\n    \n    --TOO LATE\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) < (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    THEN \"EKPO\".\"NETWR_CONVERTED\"*ABS((DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>)/365.0))*(<%= OTD_LATE_SAFETYSTOCK %>/100.0)*(<%= OTD_LATE_INVENTORYCOST %>/100.0)*(<%= OTD_LATE_POT %>/100.0)\n    --'Late delivery'\n    --outside the On time delivery interval, too late\n    \n    ELSE 0.0\n    --'Other'\n    \nEND)"
  },
  {
    "description": null,
    "id": "9a51643f-622f-491f-be2a-a7254aaf1160",
    "name": "Impact: OTD Early",
    "parameterCount": 0,
    "parameters": [],
    "template": "--IF ANALYSIS KPI = Confirmed delivery date: The last date of every PO Item in the delivery date of vendor confirmation table \n--GR_VARIABLE = the last date of every PO Item in the goods receipt activity\n<%= Time_Factor %>\n\n--ANANLYSIS KPI = planned arrival date\n--GR_VARIABLE = actual arrival date\n--LATEST_DATE = latest date in dataset\n--DAYS_BETWEEN(X,Y) = Y - X [days]\n\n*SUM(CASE\n    \n    --NO PLANNED ARRIVAL TIME\n    WHEN ISNULL(<%= ANALYSIS_KPI %>) = 1 \n    THEN 0.0\n    --'No order confirmation'\n    \n    --ON TIME (POTENTIALLY)\n    WHEN ISNULL(<%= GR_VARIABLE %>) = 1 \n    AND DAYS_BETWEEN(TO_TIMESTAMP('<%= OTD_LATESTDATE %>','YYYYMMDD'),<%= ANALYSIS_KPI %>) >= 0 \n    THEN 0.0\n    --'No goods receipt but future due date'\n    --'On time delivery'\n    \n    --TOO LATE, NO GR\n    WHEN ISNULL(<%= GR_VARIABLE %>) = 1 \n    AND DAYS_BETWEEN(TO_TIMESTAMP('<%= OTD_LATESTDATE %>','YYYYMMDD'),<%= ANALYSIS_KPI %>)  < 0 \n    THEN 0.0\n    --'No goods receipt and due date passed'\n    --'Late delivery'\n    \n    --ON TIME WITH EARLY INTERVAL\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) >= 0\n    AND DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) <= <%= OKIfDeliveredXdaysEarly %>\n    THEN 0.0\n    --'On time delivery'\n    --although a little early, it is within the early interval of everything between 0 to x days early\n    \n    --ON TIME WITH LATE INTERVAL\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) <= 0\n    AND DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) >= (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    THEN 0.0\n    --'On time delivery'\n    --although a little late, it is within the late interval of everything between 0 to x days late\n    \n    --TOO EARLY\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) > <%= OKIfDeliveredXdaysEarly %>\n    THEN \"EKPO\".\"NETWR_CONVERTED\"*(DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>)/365.0)*(<%= ROIC %>/100.0)*(<%= OTD_EARLY_POT %>/100.0)\n    --'Early delivery'\n    --outside the On time delivery interval, too early\n    \n    --TOO LATE BUT SHORT NOTICE\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) < (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    --AND (confirmation date - create PO item date) < short notice threshold\n    AND DAYS_BETWEEN(PU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"EVENTTIME\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Create Purchase Order Item'), <%= ANALYSIS_KPI %>) < <%= ShortNoticeThreshold %>\n    THEN 0.0\n    --'Late delivery but short notice'\n    --'Delivery too late but short notice purchase order'\n    \n    --TOO LATE\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) < (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    THEN 0.0\n    --'Late delivery'\n    --outside the On time delivery interval, too late\n    \n    ELSE 0.0\n    --'Other'\n    \nEND)\n\n\n+\n\n\n<%= Time_Factor %>\n\n--ANANLYSIS KPI = planned arrival date\n--GR_VARIABLE = actual arrival date\n--LATEST_DATE = latest date in dataset\n--DAYS_BETWEEN(X,Y) = Y - X [days]\n\n*(<%= OTD_EARLY_POT %>/100.0)\n*1.0\n*SUM(CASE\n    \n    --NO PLANNED ARRIVAL TIME\n    WHEN ISNULL(<%= ANALYSIS_KPI %>) = 1 \n    THEN 0.0\n    --'No order confirmation'\n    \n    --ON TIME (POTENTIALLY)\n    WHEN ISNULL(<%= GR_VARIABLE %>) = 1 \n    AND DAYS_BETWEEN(TO_TIMESTAMP('<%= OTD_LATESTDATE %>','YYYYMMDD'),<%= ANALYSIS_KPI %>) >= 0 \n    THEN 0.0\n    --'No goods receipt but future due date'\n    --'On time delivery'\n    \n    --TOO LATE, NO GR\n    WHEN ISNULL(<%= GR_VARIABLE %>) = 1 \n    AND DAYS_BETWEEN(TO_TIMESTAMP('<%= OTD_LATESTDATE %>','YYYYMMDD'),<%= ANALYSIS_KPI %>)  < 0 \n    THEN 0.0\n    --'No goods receipt and due date passed'\n    --'Late delivery'\n    \n    --ON TIME WITH EARLY INTERVAL\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) >= 0\n    AND DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) <= <%= OKIfDeliveredXdaysEarly %>\n    THEN 0.0\n    --'On time delivery'\n    --although a little early, it is within the early interval of everything between 0 to x days early\n    \n    --ON TIME WITH LATE INTERVAL\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) <= 0\n    AND DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) >= (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    THEN 0.0\n    --'On time delivery'\n    --although a little late, it is within the late interval of everything between 0 to x days late\n    \n    --TOO EARLY\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) > <%= OKIfDeliveredXdaysEarly %>\n    THEN \"EKPO\".\"NETWR_CONVERTED\" * (DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>)/365.0) * (<%= OTD_EARLY_INVENTORYCOST %>/100.0)\n    --'Early delivery'\n    --outside the On time delivery interval, too early\n    \n    --TOO LATE BUT SHORT NOTICE\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) < (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    --AND (confirmation date - create PO item date) < short notice threshold\n    AND DAYS_BETWEEN(PU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"EVENTTIME\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Create Purchase Order Item'), <%= ANALYSIS_KPI %>) < <%= ShortNoticeThreshold %>\n    THEN 0.0\n    --'Late delivery but short notice'\n    --'Delivery too late but short notice purchase order'\n    \n    --TOO LATE\n    WHEN DAYS_BETWEEN(<%= GR_VARIABLE %>, <%= ANALYSIS_KPI %>) < (-1.0)*<%= OKIfDeliveredXdaysLate %>\n    THEN 0.0\n    --'Late delivery'\n    --outside the On time delivery interval, too late\n    \n    ELSE 0.0\n    --'Other'\n    \nEND)"
  },
  {
    "description": null,
    "id": "36711412-924c-4050-ae01-be2aa969dd80",
    "name": "Impact: Order bundling (external)",
    "parameterCount": 0,
    "parameters": [],
    "template": "--OB SPECIFIC YEAR FACTOR\r\n(1.0*<%= OB_CALENDARWEEKS %>/\r\nCOUNT(DISTINCT \r\n    CASE \r\n    WHEN YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %>\r\n    THEN CALENDAR_WEEK(\"EKKO\".\"AEDAT\")\r\n    ELSE NULL\r\n    END))\r\n*(<%= OB_EXT_NEGO %>/100.0)\r\n*(<%= OB_EXT_POT %>/100.0)\r\n*\r\n(\r\nSUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=1 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=1 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=2 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=2 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=3 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=3 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=4 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=4 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=5 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=5 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=6 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=6 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=7 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=7 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=8 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=8 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=9 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=9 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=10 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=10 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=11 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=11 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=12 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=12 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=13 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=13 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=14 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=14 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=15 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=15 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=16 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=16 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=17 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=17 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=18 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=18 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=19 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=19 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=20 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=20 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=21 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=21 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=22 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=22 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=23 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=23 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=24 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=24 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=25 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=25 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=26 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=26 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=27 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=27 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=28 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=28 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=29 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=29 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=30 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=30 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=31 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=31 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=32 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=32 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=33 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=33 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=34 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=34 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=35 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=35 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=36 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=36 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=37 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=37 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=38 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=38 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=39 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=39 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=40 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=40 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=41 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=41 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=42 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=42 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=43 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=43 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=44 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=44 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=45 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=45 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=46 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=46 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=47 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=47 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=48 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=48 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=49 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=49 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=50 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=50 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=51 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=51 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=52 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=52 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=53 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=53 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=54 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=54 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n+SUM(CASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=55 AND ISNULL(\"EKPO\".\"EBELN\")=0 AND ISNULL(\"LFA1\".\"VBUND\") = 1 AND \"EKPO\".\"LOEKZ\" NOT IN ('L')) > <%= OB_EXT_THRESH %> AND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=55 THEN \"EKPO\".\"NETWR_CONVERTED\" ELSE 0.0 END)\r\n\r\n)"
  },
  {
    "description": null,
    "id": "ae427c39-38fe-474e-8990-1b11c66cb446",
    "name": "Testa",
    "parameterCount": 0,
    "parameters": [],
    "template": "SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_1 %>'\r\n)\r\n)"
  },
  {
    "description": null,
    "id": "fcb50106-be9d-4ec8-8fe3-db8d07bcf527",
    "name": "Breakeven: Cumulative Cost Year 3",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= COSTS_IM%> + 3*<%= COSTS_OP%> + <%= COSTS_LI%>*3"
  },
  {
    "description": null,
    "id": "94173fbc-edf6-4298-9e6b-b2cff6b0c07f",
    "name": "Breakeven: Cumulative Return Year 2",
    "parameterCount": 0,
    "parameters": [],
    "template": "KPI(\"Breakeven: Cumulative Impact Year 2\")-KPI(\"Breakeven: Cumulative Cost Year 2\")"
  },
  {
    "description": null,
    "id": "85a1192a-b8fe-449f-8d65-9750e0340e23",
    "name": "Breakeven: Cumulative Return Year 3",
    "parameterCount": 0,
    "parameters": [],
    "template": "KPI(\"Breakeven: Cumulative Impact Year 3\")-KPI(\"Breakeven: Cumulative Cost Year 3\")"
  },
  {
    "description": null,
    "id": "b787c993-394c-4623-a0e9-13214ebfe995",
    "name": "Impact: Changes",
    "parameterCount": 0,
    "parameters": [],
    "template": "AVG(CASE \n    WHEN ISNULL(\"EKPO\".\"KONNR\")=1 AND \"EKKO\".\"BSART_TEXT\" IN (<%=CU_DOCTYPES%>)\n    AND ISNULL(\"LFA1\".\"VBUND\") = 1\n    THEN 0.0 \n    WHEN ISNULL(\"EKPO\".\"KONNR\")=0 AND \"EKKO\".\"BSART_TEXT\" IN (<%=CU_DOCTYPES%>)\n    AND ISNULL(\"LFA1\".\"VBUND\") = 1\n    THEN 1.0\n    ELSE NULL \n    END)"
  },
  {
    "description": null,
    "id": "64a02fb5-b977-4642-bdc0-7eb484212f68",
    "name": "Breakeven: Cumulative Impact Year 2",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= IMPACT_POV %>*(<%= FULFIL1 %>/100.0) + <%= IMPACT_POV %>* (<%= FULFIL2 %>/100.0)"
  },
  {
    "description": null,
    "id": "ed64976e-d7a9-403d-86ab-7b70b98c471d",
    "name": "Impact: Overall",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= Factor %>\r\n*\r\n(\r\nKPI(\"Impact: Manual changes\")\r\n+KPI(\"Impact: Automation\")\r\n+KPI(\"Impact: Payment Blocks\")\r\n+KPI(\"Impact: EDI\")\r\n+KPI(\"Impact: Order bundling (internal)\")\r\n+KPI(\"Impact: Order bundling (external)\")\r\n+KPI(\"Impact: OTD Early\")\r\n+KPI(\"Impact: OTD Late\")\r\n+KPI(\"Impact: Rework\")\r\n+KPI(\"Impact: Maverick Buying\")\r\n--+KPI(\"Impact: Contract Usage\")\r\n--+KPI(\"Impact: Supplier consolidation\")\r\n)"
  },
  {
    "description": null,
    "id": "ebdabe24-57af-4d08-b88b-0b26bc2ebc51",
    "name": "Breakeven: ROI Year 1",
    "parameterCount": 0,
    "parameters": [],
    "template": "KPI(\"Breakeven: Cumulative Return Year 1\")/KPI(\"Breakeven: Cumulative Cost Year 1\")"
  },
  {
    "description": null,
    "id": "6522e58f-d4e6-414d-b446-b5c1b1144d3d",
    "name": "Breakeven: Cumulative Impact Year 1",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= IMPACT_POV %> *(<%= FULFIL1 %>/100.0)"
  },
  {
    "description": null,
    "id": "04e3a5d7-4d01-40ad-8c9a-caf10aada981",
    "name": "Breakeven: Cumulative Impact Year 3",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= IMPACT_POV %>*(<%= FULFIL1 %>/100.0) \n+ <%= IMPACT_POV %>* (<%= FULFIL2 %>/100.0)\n+<%= IMPACT_POV %> * (<%= FULFIL3 %>/100.0)"
  },
  {
    "description": null,
    "id": "dad86065-cb6e-4cb1-bc99-b718d1239951",
    "name": "Breakeven: NPV",
    "parameterCount": 0,
    "parameters": [],
    "template": "(<%= IMPACT_POV %>*<%= FULFIL1 %>/100.0 - (<%= COSTS_LI %> +<%= COSTS_OP %>+<%= COSTS_IM %>))/(1+ (<%= BREAKEVEN_INTEREST %>)/100.0)\n+ (<%= IMPACT_POV %>*<%= FULFIL2 %>/100.0 - (<%= COSTS_LI %> +<%= COSTS_OP %>))/POWER((1+ (<%= BREAKEVEN_INTEREST %>)/100.0),2)\n+ (<%= IMPACT_POV %>*<%= FULFIL3 %>/100.0 - (<%= COSTS_LI %> +<%= COSTS_OP %>))/POWER((1+ (<%= BREAKEVEN_INTEREST %>)/100.0),3)"
  },
  {
    "description": "",
    "id": "b5156964-d8a8-45a1-81c9-c67457b064a0",
    "name": "Impact: Process Breaks",
    "parameterCount": 0,
    "parameters": [],
    "template": "ROUND(<%= Time_Factor %>*(\n\n\n(<%= PB_1_REL %>/100.0)*\n--minutes of rework activity\n<%= PB_1_TIME %>\n\n--fte cost per minute\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\n\n*\n\n\n\nSUM (CASE\n\nWHEN PROCESS EQUALS '<%= FromPB1 %>' TO ANY TO '<%= ToPB1 %>' THEN 1.0 ELSE 0.0\n\nEND\n\n)\n/*\n\n+\n\n(<%= PB_2_REL %>/100.0)*\n--minutes of rework activity\n<%= PB_2_TIME %>\n\n--fte cost per minute\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\n\n*\n\nSUM (CASE\n\nWHEN PROCESS EQUALS '<%= FromPB2 %>' TO ANY TO '<%= ToPB2 %>' THEN 1.0 ELSE 0.0\n\nEND\n\n\n\n)+\n\n(<%= PB_3_REL %>/100.0)*\n--minutes of rework activity\n<%= PB_3_TIME %>\n\n--fte cost per minute\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\n\n*\n\nSUM (CASE\n\nWHEN PROCESS EQUALS '<%= FromPB3 %>' TO ANY TO '<%= ToPB3 %>' THEN 1.0 ELSE 0.0\n\nEND\n)\n\n*/\n\n\n\n\n\n\n\n))"
  },
  {
    "description": "",
    "id": "9cc4c0c0-6758-4f0e-9609-c78643afed96",
    "name": "Stock",
    "parameterCount": 0,
    "parameters": [],
    "template": "'1071', '1072', '3000', '3001', '3002', '3003', '3004', '3005', '3006', '3007', '3008', '3009', '3010', '3011', '3012', '3013', '3014', '3015', '3016', '3017', '3018', '3019', '3020', '3021', '3022', '3023', '3024', '3025', '3026', '3027', '3028', '3029', '3030', '3031', '3032', '3033', '3034', '3035', '3036', '3037', '3038', '4000', '4001', '4002', '4003', '4004', '4005', '4006', '4007', '4008', '4009', '4010', '4011', '4012', '4013', '4014', '4015', '4016', '4017', '4018', '4019', '4020', '4021', '4022', '4023', '4024', '4025', '4026', '4027', '4028', '4029', '4030', '4031', '4032', '4033', '4034', '4035', '4036', '4037', '4038', '4039', '4040', '4041', '4042', '4043', '4044', '4045', '4046', '4047', '4048', '4049', '4050', '4051', '4052', '4053', '4054', '4055', '4056', '4057', '4058', '4059', '4060', '4061', '4062', '4063', '4064', '4065', '4066', '4067', '4068', '4069', '4070', '4071', '4072', '4073', '4074', '4075', '4076', '4077', '4078', '4079', '4080', '4081', '4082', '4083', '4084', '4085', '4086', '4087', '4088', '4089', '4090', '4091', '4092', '4093', '4094', '4095', '4096', '4097', '4098', '4099', '4100', '4101', '4102', '4103', '4104', '4105', '4106', '4107', '4108', '4109', '4110', '4111', '4112', '4113', '4114', '4115', '4116', '5000', '5001', '5002', '5003', '5004', '5005', '5006', '5007', '5008', '5009', '6000', '6001', '6002', '6003', '6004', '6005', '6006', '6007', '6008', '6009', '6010', '6011', '6012', '6013', '6014', '6015', '6016', '6017', '6018', '6019', '6020', '6021', '6022', '6023', '6024', '6025', '6026', '6027', '6028', '6029', '6030', '6031', '6032', '6033', '6034', '6035', '6036', '6037', '6038', '6039', '6040', '6041', '6042', '6043', '6044', '6045', '6046', '6047', '6048', '6049', '6050', '6051', '6052', '6053', '6054', '6055', '6056', '6057', '6058', '6059', '6500', '6501', '6999', '7000', '7001'"
  },
  {
    "description": null,
    "id": "ec29bbec-482d-43f6-bf76-ddf75db78c81",
    "name": "PI_TOTALPIT",
    "parameterCount": 0,
    "parameters": [],
    "template": "SUM(CASE\r\nWHEN\r\n--Ignore Dummy Price Changes\r\n(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = 0.0 OR\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy1 %> OR\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy2 %> OR\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy3 %> ) \r\nTHEN 0.0\r\n\r\nWHEN\r\n(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = 0.0 OR\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy1 %> OR\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy2 %> OR\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy3 %> )\r\nAND \r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\r\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') != 1.0 AND\r\n--mutilple price increases after initial dummy value prices smaller than threshold\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\r\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') < 1.0\r\nAND \r\n( \r\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')/\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')-1.0)    <= (<%= PI_THRESHOLD %>/100.0)\r\n\r\nTHEN\r\n   1.0\r\n\r\nWHEN   \r\nISNULL(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')) = 0\r\nAND \r\n-- Real Price Increases inside of threshold\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\r\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') < 1.0 AND\r\n(\r\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')/\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')-1.0 )   <= (<%= PI_THRESHOLD %>/100.0)\r\n\r\nTHEN \r\n   1.0\r\n   \r\n   \r\n   WHEN   \r\nISNULL(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')) = 0\r\nAND \r\n--Real Price Increases outside of threshold\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\r\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')  < 1.0 AND\r\n(\r\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')/\r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')-1 )   > (<%= PI_THRESHOLD %>/100.0)\r\n\r\nTHEN \r\n   0.0\r\n--Price recudction  \r\nWHEN ISNULL(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')) = 0\r\nAND \r\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\r\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') > 1.0 \r\n\r\nTHEN 0.0\r\nELSE 0.0\r\nEND)"
  },
  {
    "description": null,
    "id": "2fd7c8e4-9b97-4de2-b51a-0785283059b0",
    "name": "Impact: Three Way (effort)",
    "parameterCount": 0,
    "parameters": [],
    "template": "\r\nROUND(<%= Time_Factor %>* (\r\n\r\n--minutes of no three way match\r\n<%= THREEWAY_TIME %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce non three way matches\r\n*(<%= THREEWAY_TIME_POT %>/100.0)\r\n\r\n\r\n--quantity of non three way matches\r\n*SUM(\r\nCASE WHEN PU_COUNT(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\",\"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Record Goods Receipt') > 0 AND PU_COUNT(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\",\"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Record Invoice Receipt') > 0\r\n THEN (\r\n\r\nCASE\r\n-- No quantity match if order quantity is 0\r\nWHEN \"EKPO\".\"MENGE\" = 0.0 THEN 1.0 \r\nWHEN-- Quantity match\r\n\r\n    --Order Quantity = GR Quantity\r\n    (((1.0*\"EKPO\".\"MENGE\") - (1.0*PU_SUM(\"EKPO\",\"EKBE\".\"MENGE\",\"EKBE\".\"VGABE\"='1' AND \"EKBE\".\"SHKZG\" = 'S'))) >= (-1*((1.0*\"EKPO\".\"MENGE\") *(<%=tolerance_high_quantity%>/100.00)))) \r\n    AND (((1.0*\"EKPO\".\"MENGE\") - (1.0*PU_SUM(\"EKPO\",\"EKBE\".\"MENGE\",\"EKBE\".\"VGABE\"='1' AND \"EKBE\".\"SHKZG\" = 'S'))) <= (((1.0*\"EKPO\".\"MENGE\")*(<%=tolerance_low_quantity%>/100.00))))\r\n    -- Order Quantity = IR Quantity\r\n    AND (((1.0*\"EKPO\".\"MENGE\") - (1.0*PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) >= (-1*((1.0*\"EKPO\".\"MENGE\") *(<%=tolerance_high_quantity%>/100.00)))) \r\n    AND (((1.0*\"EKPO\".\"MENGE\") - (1.0*PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) <= (((1.0*\"EKPO\".\"MENGE\")*(<%=tolerance_low_quantity%>/100.00))))\r\n    -- IR Quantity = GR Quantity (with tolerance of Order Quanitty)\r\n  AND (((1.0*PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\")) - (1.0*PU_SUM(\"EKPO\",\"EKBE\".\"MENGE\",\"EKBE\".\"VGABE\"='1' AND \"EKBE\".\"SHKZG\" = 'S'))) >= (-1*((1.0*\"EKPO\".\"MENGE\") *(<%=tolerance_high_quantity%>/100.00)))) \r\n    AND (((1.0*PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\")) - (1.0*PU_SUM(\"EKPO\",\"EKBE\".\"MENGE\",\"EKBE\".\"VGABE\"='1' AND \"EKBE\".\"SHKZG\" = 'S'))) <= (((1.0*\"EKPO\".\"MENGE\")*(<%=tolerance_low_quantity%>/100.00))))\r\n\r\n-- Value match \r\n--(Price per Unit (PO) - Price per Unit (Invoice) >= -price increase tolerance (diff is negative when price increases) \r\n--and Price per Unit (PO) - Price per Unit (Invoice) <= price decrease tolerance (diff is positive when price decreases))\r\n    AND(((<%=netwr%>/EKPO.MENGE) - (PU_SUM(\"EKPO\",\"RSEG\".\"WRBTR\")/PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) >= (-1*((<%=netwr%>/EKPO.MENGE)*(<%=tolerance_high_price%>/100.00)))) \r\n    AND (((<%=netwr%>/EKPO.MENGE) - (PU_SUM(\"EKPO\",\"RSEG\".\"WRBTR\")/PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) <= (((<%=netwr%>/EKPO.MENGE)*(<%=tolerance_low_price%>/100.00))))\r\nTHEN 0.0\r\n    WHEN(    --Order Quantity = GR Quantity\r\n    (((1.0*\"EKPO\".\"MENGE\") - (1.0*PU_SUM(\"EKPO\",\"EKBE\".\"MENGE\",\"EKBE\".\"VGABE\"='1' AND \"EKBE\".\"SHKZG\" = 'S'))) >= (-1*((1.0*\"EKPO\".\"MENGE\") *(<%=tolerance_high_quantity%>/100.00)))) \r\n    AND (((1.0*\"EKPO\".\"MENGE\") - (1.0*PU_SUM(\"EKPO\",\"EKBE\".\"MENGE\",\"EKBE\".\"VGABE\"='1' AND \"EKBE\".\"SHKZG\" = 'S'))) <= (((1.0*\"EKPO\".\"MENGE\")*(<%=tolerance_low_quantity%>/100.00))))\r\n    -- Order Quantity = IR Quantity\r\n    AND (((1.0*\"EKPO\".\"MENGE\") - (1.0*PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) >= (-1*((1.0*\"EKPO\".\"MENGE\") *(<%=tolerance_high_quantity%>/100.00)))) \r\n    AND (((1.0*\"EKPO\".\"MENGE\") - (1.0*PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) <= (((1.0*\"EKPO\".\"MENGE\")*(<%=tolerance_low_quantity%>/100.00))))\r\n    -- GR Quantity = IR Quantity (with tolerance of Order Quanitty)\r\n    AND (((1.0*PU_SUM(\"EKPO\",\"EKBE\".\"MENGE\",\"EKBE\".\"VGABE\"='1' AND \"EKBE\".\"SHKZG\" = 'S')) - (1.0*PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) >= (-1*((1.0*\"EKPO\".\"MENGE\") *(<%=tolerance_high_quantity%>/100.00)))) \r\n    AND (((1.0*PU_SUM(\"EKPO\",\"EKBE\".\"MENGE\",\"EKBE\".\"VGABE\"='1' AND \"EKBE\".\"SHKZG\" = 'S')) - (1.0*PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) <= (((1.0*\"EKPO\".\"MENGE\")*(<%=tolerance_low_quantity%>/100.00))))\r\n)\r\n    THEN 1.0\r\n    WHEN\r\n        ((((<%=netwr%>/EKPO.MENGE) - (PU_SUM(\"EKPO\",\"RSEG\".\"WRBTR\")/PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) >= (-1*((<%=netwr%>/EKPO.MENGE)*(<%=tolerance_high_price%>/100.00)))) AND\r\n        (((<%=netwr%>/EKPO.MENGE) - (PU_SUM(\"EKPO\",\"RSEG\".\"WRBTR\")/PU_SUM(\"EKPO\",\"RSEG\".\"MENGE\"))) <= (((<%=netwr%>/EKPO.MENGE)*(<%=tolerance_low_price%>/100.00)))))\r\n    THEN 1.0\r\n    ELSE 1.0\r\nEND)\r\nELSE 0.0\r\nEND )))\r\n\r\n\r\n"
  },
  {
    "description": "",
    "id": "85cc76f8-a2ec-4b89-8c80-5f6d3ee28e56",
    "name": "CHANGE_ACT_1_FI",
    "parameterCount": 0,
    "parameters": [],
    "template": "--minutes of change activity\r\n<%= CHANGE_ACT_1_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_1_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_1 %>'\r\n)\r\n)"
  },
  {
    "description": "",
    "id": "fb93bb27-cf2b-49cc-85fb-32a0671b4631",
    "name": "CHANGE_ACT_1_OC",
    "parameterCount": 0,
    "parameters": [],
    "template": "SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_1 %>'\r\n)\r\n)"
  },
  {
    "description": "",
    "id": "524a70a8-4953-4dc6-9339-73316a689a97",
    "name": "CHANGE_ACT_2_OC",
    "parameterCount": 0,
    "parameters": [],
    "template": "SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_2 %>'\r\n)\r\n)"
  },
  {
    "description": "",
    "id": "1bc1a22b-f4fc-4e4e-a9be-4cb91b8a78f1",
    "name": "CHANGE_ACT_2_FI",
    "parameterCount": 0,
    "parameters": [],
    "template": "--minutes of change activity\r\n<%= CHANGE_ACT_2_EFF %>\r\n\r\n--fte cost per minute\r\n*(<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n\r\n--potential to reduce change act\r\n*(<%= CHANGE_ACT_2_POT %>/100.0)\r\n\r\n--quantity of change activity\r\n*SUM(\r\nPU_COUNT(\r\n    \"EKPO\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"_CASE_KEY\",\r\n    \"_CEL_P2P_ACTIVITIES\".\"USER_TYPE\"='A' AND \r\n    \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = '<%= CHANGE_ACT_2 %>'\r\n)\r\n)"
  },
  {
    "description": "",
    "id": "0b5bc119-c536-48e8-9a10-000ff47f1455",
    "name": "Impact: Order bundling (effort)",
    "parameterCount": 0,
    "parameters": [],
    "template": "(1.0*<%= OB_CALENDARWEEKS %>\r\n\r\n/\r\n\r\n\r\nCOUNT(DISTINCT \r\n    CASE \r\n    WHEN YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %>\r\n    THEN CALENDAR_WEEK(\"EKKO\".\"AEDAT\")\r\n    ELSE NULL\r\n    END))\r\n\r\n*\r\n\r\n\r\n((<%= FTE_COST %>/(<%= FTE_HOURS %>*60.0))\r\n*<%= OB_TIMESAVED %>\r\n*(<%= OB_POT %>/100.0)\r\n*\r\n(\r\n\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=1 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=1 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=1 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=1 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=2 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=2 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=2 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=2 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=3 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=3 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=3 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=3 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=4 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=4 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=4 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=4 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=5 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=5 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=5 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=5 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=6 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=6 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=6 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=6 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=7 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=7 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=7 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=7 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=8 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=8 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=8 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=8 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=9 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=9 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=9 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=9 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=10 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=10 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=10 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=10 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=11 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=11 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=11 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=11 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=12 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=12 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=12 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=12 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=13 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=13 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=13 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=13 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=14 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=14 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=14 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=14 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=15 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=15 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=15 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=15 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=16 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=16 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=16 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=16 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=17 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=17 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=17 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=17 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=18 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=18 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=18 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=18 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=19 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=19 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=19 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=19 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=20 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=20 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=20 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=20 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=21 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=21 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=21 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=21 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=22 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=22 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=22 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=22 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=23 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=23 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=23 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=23 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=24 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=24 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=24 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=24 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=25 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=25 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=25 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=25 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=26 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=26 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=26 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=26 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=27 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=27 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=27 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=27 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=28 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=28 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=28 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=28 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=29 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=29 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=29 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=29 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=30 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=30 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=30 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=30 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=31 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=31 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=31 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=31 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=32 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=32 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=32 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=32 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=33 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=33 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=33 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=33 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=34 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=34 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=34 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=34 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=35 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=35 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=35 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=35 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=36 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=36 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=36 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=36 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=37 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=37 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=37 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=37 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=38 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=38 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=38 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=38 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=39 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=39 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=39 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=39 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=40 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=40 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=40 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=40 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=41 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=41 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=41 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=41 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=42 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=42 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=42 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=42 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=43 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=43 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=43 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=43 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=44 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=44 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=44 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=44 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=45 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=45 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=45 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=45 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=46 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=46 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=46 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=46 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=47 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=47 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=47 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=47 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=48 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=48 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=48 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=48 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=49 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=49 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=49 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=49 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=50 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=50 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=50 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=50 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=51 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=51 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=51 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=51 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=52 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=52 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=52 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=52 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=53 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=53 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=53 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=53 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n+\r\n(SUM(\r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=54 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=54 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN 1.0/PU_COUNT(\"EKKO\",\"EKPO\".\"EBELP\") ELSE 0.0 END)\r\n- \r\nCOUNT(DISTINCT \r\nCASE WHEN 1.0*PU_COUNT_DISTINCT( \"LFB1\", \"EKKO\".\"EBELN\", YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=54 ) > <%= OB_EXT_THRESH %> \r\nAND YEAR(\"EKKO\".\"AEDAT\") = <%= OB_YEAR %> AND CALENDAR_WEEK(\"EKKO\".\"AEDAT\")=54 \r\nAND ISNULL(\"EKPO\".\"EBELN\")=0 AND \"EKPO\".\"LOEKZ\" NOT IN ('L') \r\nTHEN \"LFB1\".\"MANDT\"||\"LFB1\".\"BUKRS\"||\"LFB1\".\"LIFNR\" \r\nELSE NULL \r\nEND)*<%= OB_EXT_THRESH %>)\r\n)\r\n)"
  },
  {
    "description": "",
    "id": "c8add979-07d2-476e-b047-1c080af4f8e5",
    "name": "Contract Usage Ratio",
    "parameterCount": 0,
    "parameters": [],
    "template": "AVG(CASE \n    WHEN ISNULL(\"EKPO\".\"KONNR\")=1 AND \"EKKO\".\"BSART_TEXT\" IN (<%=CU_DOCTYPES%>)\n    AND ISNULL(\"LFA1\".\"VBUND\") = 1\n    THEN 0.0 \n    WHEN ISNULL(\"EKPO\".\"KONNR\")=0 AND \"EKKO\".\"BSART_TEXT\" IN (<%=CU_DOCTYPES%>)\n    AND ISNULL(\"LFA1\".\"VBUND\") = 1\n    THEN 1.0\n    ELSE NULL \n    END)"
  },
  {
    "description": null,
    "id": "214aa0b0-a6fd-409a-8133-83b0b8d4dd3b",
    "name": "Impact: Maverick Buying",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= Time_Factor %>\r\n*(<%=MB_POT %>/100.0)\r\n*\r\n\r\n1.0*SUM(\r\nCASE \r\n    WHEN\r\n    PROCESS EQUALS 'Vendor Creates Invoice' TO ANY TO 'Create Purchase Order Item' AND ISNULL(\"LFA1\".\"VBUND\") = 1\r\n    THEN \r\n    1.0*\"EKPO\".\"NETWR_CONVERTED\"*(<%=MB_SAVING %>/100.0)\r\n    ELSE NULL\r\nEND\r\n)"
  },
  {
    "description": null,
    "id": "eaee6894-2c5c-44f8-9571-f0b2d1941c5f",
    "name": "Impact: Price Increases",
    "parameterCount": 0,
    "parameters": [],
    "template": "\n\n\nROUND(<%= Time_Factor %>* (\n\n\n(<%= PI_REALIZATION %>/100.0)*\n\nSUM(CASE\nWHEN\n--Ignore Dummy Price Changes \n(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = 0.0 OR \nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy1 %> OR\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy2 %> OR\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy3 %> ) AND \nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = 1.0\nTHEN 0.0\n--Multiple price increases after dummy value within threshold\nWHEN\n(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = 0.0 OR\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy1 %> OR\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy2 %> OR\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') = <%= PI_Dummy3 %> ) AND\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') <= 1.0\nAND \n\n( \nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')/\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')-1.0)    <= (<%= PI_THRESHOLD %>/100.0)\nTHEN\n0.0\n--Price increaases within threshold\nWHEN   \nISNULL(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')) = 0\nAND \nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') <= 1.0 AND\n(\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')/\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')-1.0 )   <= (<%= PI_THRESHOLD %>/100.0)\n\nTHEN \n   PU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')\n       - PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')\n   \n--Price increases outside of theshold   \nWHEN   \nISNULL(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')) = 0\nAND \n\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')  <= 1.0 AND\n(\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')/\nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')-1 )   > (<%= PI_THRESHOLD %>/100.0)\n\nTHEN \n   0.0\n--Price reductions   \nWHEN ISNULL(PU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price')) = 0\nAND \nPU_FIRST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_FROM_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') /\nPU_LAST(\"EKPO\", \"_CEL_P2P_ACTIVITIES\".\"CHANGED_TO_FLOAT\", \"_CEL_P2P_ACTIVITIES\".\"ACTIVITY_EN\" = 'Change Price') > 1.0 \n\nTHEN 0.0\nELSE 0.0\nEND)))"
  },
  {
    "description": "",
    "id": "6886ebf6-8a07-414f-88ca-fb065d874f6e",
    "name": "Contract Usage 2",
    "parameterCount": 0,
    "parameters": [],
    "template": "100.0*AVG(\n    CASE WHEN COALESCE(\"EKPO\".\"KONNR\",'') = ''\n    THEN 0.0\n    ELSE 1.0\nEND)"
  },
  {
    "description": null,
    "id": "3e5d2614-fe4c-417e-9ccc-92ae01288150",
    "name": "Impact: Free Text Order",
    "parameterCount": 0,
    "parameters": [],
    "template": "<%= Time_Factor %>\n*(<%= Freetext_TAR %>/100.0) * (<%= Freetext_Negotiation %>/100.0)\n* SUM(\nCASE \n    WHEN COALESCE(\"EKPO\".\"KONNR\", '' )= '' AND \n    PROCESS NOT EQUALS 'Lege BANF Position an' AND \n    COALESCE(\"EKPO\".\"MATNR\", '' )= ''\n    THEN \"EKPO\".\"NETWR_CONVERTED\" \n    ELSE 0.0 \nEND)"
  }
]